<!DOCTYPE html>
<html>
<head>
    <title>TikTok Style - Selected Videos</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body, html {
            margin:0;
            padding:0;
            overflow-x:hidden;
            background:black;
            font-family:Arial, sans-serif;
        }
        .top-left-text {
            position: fixed;
            top: 10px;
            left: 10px;
            font-size: 28px;
            font-weight: bold;
            color: white;
            background: rgba(0,0,0,0.5);
            padding: 8px 12px;
            border-radius:10px;
            z-index: 9999;
        }
        .video-container {
            width:100%;
            height:100vh;
            scroll-snap-type:y mandatory;
            overflow-y:scroll;
            scroll-behavior: smooth;
        }
        .video-item {
            width:100%;
            height:100vh;
            scroll-snap-align:start;
            position:relative;
            display:flex;
            justify-content:center;
            align-items:center;
            flex-direction:column;
        }
        .embed-wrapper {
            position: relative;
            width:100%;
            height:100%;
        }
        .embed-wrapper video {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: contain;
            background: black;
        }
        .embed-wrapper iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .title {
            position:absolute;
            bottom:120px;
            left:20px;
            font-size:24px;
            background:rgba(0,0,0,0.5);
            padding:10px;
            border-radius:10px;
            color:white;
        }
        .like-btn {
            position:absolute;
            bottom:70px;
            left:20px;
            font-size:20px;
            background:rgba(255,0,0,0.7);
            color:white;
            border:none;
            padding:10px 20px;
            border-radius:10px;
            cursor:pointer;
            transition: 0.15s ease;
        }
    </style>
</head>
<body>

<div class="top-left-text">GOON üêâ</div>

<div class="video-container" id="videoContainer">

    <!-- Jumpshare videos remain static -->
    <div class="video-item" data-video="jumpshare3">
        <div class="embed-wrapper">
            <iframe src="https://jumpshare.com/embed/FvVicCPZfGU6vP8ODpxg" frameborder="0" allowfullscreen></iframe>
        </div>
        <div class="title">Jumpshare Video 3</div>
        <button class="like-btn">‚ù§Ô∏è 0</button>
    </div>

    <div class="video-item" data-video="jumpshare5">
        <div class="embed-wrapper">
            <iframe src="https://jumpshare.com/embed/yXJerJAzir7JMJKTCySF" frameborder="0" allowfullscreen></iframe>
        </div>
        <div class="title">Jumpshare Video 5</div>
        <button class="like-btn">‚ù§Ô∏è 0</button>
    </div>

</div>

<script>
const container = document.getElementById("videoContainer");
const localVideoElements = [];

// ---------- AUTOMATIC GITHUB FOLDER VIDEO LOADER ----------
// CHANGE THESE TO MATCH YOUR REPO
const username = "deadaddeadad32-cell";      // Your GitHub username
const repo = "tiktok-style";                 // Your repo name
const folder = "videos";                     // Folder containing videos
const branch = "main";                       // Branch name

const apiUrl = `https://api.github.com/repos/${username}/${repo}/contents/${folder}?ref=${branch}`;

fetch(apiUrl)
  .then(res => res.json())
  .then(files => {
    files.forEach((file, index) => {
        if(file.name.endsWith(".mp4")) { // only load mp4s
            const videoId = "local_" + index;

            const item = document.createElement("div");
            item.className = "video-item";
            item.dataset.video = videoId;

            const wrapper = document.createElement("div");
            wrapper.className = "embed-wrapper";

            const video = document.createElement("video");
            video.src = file.download_url;
            video.muted = true;
            video.controls = true;
            video.preload = "metadata";

            wrapper.appendChild(video);
            item.appendChild(wrapper);

            const title = document.createElement("div");
            title.className = "title";
            title.innerText = file.name;
            item.appendChild(title);

            const btn = document.createElement("button");
            btn.className = "like-btn";
            let likes = parseInt(localStorage.getItem(videoId + "_likes")) || 0;
            btn.innerText = `‚ù§Ô∏è ${likes}`;
            btn.addEventListener("click", () => {
                likes++;
                localStorage.setItem(videoId + "_likes", likes);
                btn.innerText = `‚ù§Ô∏è ${likes}`;
                btn.style.transform = "scale(1.2)";
                setTimeout(() => { btn.style.transform = "scale(1)"; }, 150);
            });
            item.appendChild(btn);

            container.insertBefore(item, container.firstChild);
            localVideoElements.push(video);
        }
    });

    // Autoplay visible videos
    function checkVisibleVideo() {
        localVideoElements.forEach(video => {
            const rect = video.getBoundingClientRect();
            if(rect.top >= 0 && rect.bottom <= window.innerHeight){
                video.play();
            } else {
                video.pause();
            }
        });
    }

    container.addEventListener("scroll", checkVisibleVideo);
    window.addEventListener("load", checkVisibleVideo);

  })
  .catch(err => console.error("Failed to fetch videos from GitHub:", err));

// ---------- Like buttons for iframe videos ----------
document.querySelectorAll(".video-item").forEach(item => {
    const videoId = item.dataset.video;
    const likeBtn = item.querySelector(".like-btn");

    if(!item.querySelector("video")) { // only iframe videos
        let likes = parseInt(localStorage.getItem(videoId + "_likes")) || 0;
        likeBtn.innerText = `‚ù§Ô∏è ${likes}`;
        likeBtn.addEventListener("click", ()=> {
            likes++;
            localStorage.setItem(videoId + "_likes", likes);
            likeBtn.innerText = `‚ù§Ô∏è ${likes}`;
            likeBtn.style.transform = "scale(1.2)";
            setTimeout(()=>{ likeBtn.style.transform="scale(1)"; }, 150);
        });
    }
});
</script>

</body>
</html>
